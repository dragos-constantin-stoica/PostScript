%!PS-Adobe-3.0 EPSF-3.0
%%BoundingBox: 5 5 400 600
%%LanguageLevel: 2

%This is an attempt to produce an 2D tile
%based on empty square, filled square,
%a square filled with a quarter of a circle
%and a square filled with the complement of a
%square of a circle
%The tiles may be rotated with 90 degres

/s1{
  0 0 5 5 rectstroke
}def

/s1N{
  gsave
  1 0 0 setrgbcolor
  0 0 5 5 rectfill
  grestore
}def

/q1{
    gsave
     0 0 5 0 90 arc
     0 0 lineto
     closepath
     1 0 0 setrgbcolor
     fill grestore
     s1
}def

/q2{
     gsave
     5 0 5 90 180 arc
     5 0 lineto
     closepath
     1 0 0 setrgbcolor
     fill grestore
     s1
}def

/q3{
     gsave
     5 5 5 180 270 arc
     5 5 lineto
     closepath
     1 0 0 setrgbcolor
     fill grestore
     s1
}def

/q4{
     gsave
     0 5 5 270 0 arc
     0 5 lineto
     closepath
     1 0 0 setrgbcolor
     fill grestore
     s1
}def

/q1N{
    s1N
    gsave
     0 0 5 0 90 arc
     0 0 lineto
     closepath
     1 1 1 setrgbcolor
     fill grestore
     s1
}def

/q2N{
    s1N
     gsave
     5 0 5 90 180 arc
     5 0 lineto
     closepath
     1 1 1 setrgbcolor
     fill grestore
     s1
}def

/q3N{
    s1N
     gsave
     5 5 5 180 270 arc
     5 5 lineto
     closepath
     1 1 1 setrgbcolor
     fill grestore
     s1
}def

/q4N{
    s1N
     gsave
     0 5 5 270 0 arc
     0 5 lineto
     closepath
     1 1 1 setrgbcolor
     fill grestore
     s1
}def

/sym [ //q1 //q1N //q2  //q2N //q3 //q4 //q3N //q4N //s1N //s1 ] def
/range sym length def
/rNum {rand range mod} def

%Initial setup
5 5 scale
0 setlinewidth
2 2 translate

%Start drawing

%horizontal boxes >> 15
%veritcal boxes >> 22

23 {

  14 {
    % select a random symbol to be drawn
    sym rNum get exec
    5 0 translate
  } repeat

  %go up one row
  -70 5 translate
} repeat


showpage
%%EOF
